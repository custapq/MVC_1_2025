<div class="space-y-6">
  <h1 class="text-3xl font-bold text-gray-800 mb-4">เข้าสู่ระบบ</h1>
  <form id="loginForm" class="space-y-4">
    <div class="flex items-center space-x-4 justify-center">
      <label class="flex items-center space-x-2 cursor-pointer">
        <input
          type="radio"
          name="role"
          value="student"
          id="studentRadio"
          class="form-radio text-blue-600 focus:ring-blue-500"
          checked
        />
        <span class="text-gray-700">นักเรียน</span>
      </label>
      <label class="flex items-center space-x-2 cursor-pointer">
        <input
          type="radio"
          name="role"
          value="admin"
          id="adminRadio"
          class="form-radio text-blue-600 focus:ring-blue-500"
        />
        <span class="text-gray-700">ผู้ดูแลระบบ</span>
      </label>
    </div>
    <input
      type="text"
      id="username"
      placeholder="รหัสนักเรียน / ชื่อผู้ใช้"
      class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring focus:ring-blue-200"
    />
    <input
      type="password"
      id="password"
      placeholder="รหัสผ่าน"
      class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring focus:ring-blue-200"
    />
    <button
      type="submit"
      class="w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 transition duration-300"
    >
      เข้าสู่ระบบ
    </button>
  </form>
  <div id="message" class="mt-4 text-red-500"></div>
</div>

<script>
  document
    .getElementById("loginForm")
    .addEventListener("submit", async function (e) {
      e.preventDefault();
      const role = document.querySelector('input[name="role"]:checked').value;
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;
      const messageDiv = document.getElementById("message");

      try {
        const endpoint =
          role === "student" ? "/users/login/student" : "/users/login/admin";
        // เรียก API เพื่อ login
        const response = await axios.post(endpoint, {
          user_name: username,
          user_password: password,
        });
        console.log("User ID:", response.data);
        if (response.data != null) {
          // นำ user ไปหน้า view ของแต่ละ role
          if (role === "admin") {
            window.location.href = `/${role}/${response.data[0].user_id}`
          } else {
            window.location.href = `/${role}/${response.data[0].user_name}`;
          }
        } else {
          messageDiv.textContent = "ชื่อผู้ใช้หรือรหัสผ่านไม่ถูกต้อง";
        }
      } catch (error) {
        console.error(error);
        messageDiv.textContent = "เกิดข้อผิดพลาดในการเข้าสู่ระบบ";
      }
    });
</script>
